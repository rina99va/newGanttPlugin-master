#* @vtlvariable name="action" type="com.atlassian.plugin.action.GanttAction" *#

<html>
<head>
    $webResourceManager.requireResource("com.atlassian.plugin.gantt:newGanttPlugin-resources")
    $webResourceManager.requireResource("com.atlassian.plugin.newGanttPlugin:newGanttPlugin-resources")
    $webResourceManager.requireResource("com.atlassian.auiplugin:aui-page-header")
    $webResourceManager.requireResource("com.atlassian.auiplugin:aui-sidebar")
    $webResourceManager.requireResource("com.atlassian.auiplugin:aui-button")
    $webResourceManager.requireResource("com.atlassian.auiplugin:aui-experimental-iconfont")
    #set($baseurl = $settingsManager.getGlobalSettings().getBaseUrl())
    #set($name = $action.getName())

    <link rel="stylesheet" href="https://cdn3.devexpress.com/jslib/20.2.7/css/dx-gantt.min.css">
    <script src="https://cdn3.devexpress.com/jslib/20.2.7/js/dx-gantt.min.js"></script>
    <!-- ... -->
    <script type="text/javascript" src="https://code.jquery.com/jquery-3.5.1.min.js"></script>

    <!-- DevExtreme themes -->
    <link rel="stylesheet" href="https://cdn3.devexpress.com/jslib/20.2.7/css/dx.common.css">
    <link rel="stylesheet" href="https://cdn3.devexpress.com/jslib/20.2.7/css/dx.light.css">

    <!-- DevExtreme library -->
    <script type="text/javascript" src="https://cdn3.devexpress.com/jslib/20.2.7/js/dx.all.js"></script>

    <!-- jsPDF library -->
##    <script src="https://unpkg.com/jspdf@latest/dist/jspdf.umd.min.js"></script>
##    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.3.1/jspdf.umd.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.3.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.3.1/polyfills.umd.js"></script>
##    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.3.1/polyfills.es.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.3.1/jspdf.umd.js"></script>
##    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.3.1/jspdf.node.js"></script>
##    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.3.1/jspdf.node.min.js"></script>
##    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.3.1/jspdf.es.js"></script>
##    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.3.1/jspdf.es.min.js"></script>
##    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.3.1/jspdf.debug.js"></script>

    <!-- html2canvas library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.4.1/html2canvas.min.js"></script>

    <!-- FileSaver library -->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.js"></script>

#if($action.hasAccess())
</head>
<body class="dx-viewport">

<div class="dx-viewport demo-container">
    <div class="options">
        <div class="caption">Options</div>
        <div class="option">
            <div>Scale Type</div>
            <div id="scaleType"></div>
        </div>
        <div class="option">
            <div>Title Position</div>
            <div id="titlePosition"></div>
        </div>
        <div class="option">
            <div id="showResources"></div>
        </div>
        <div class="option">
            <div id="customizeTaskTooltip"></div>
        </div>
    </div>
    <div class="aui-button">
        <div onclick="goToTaskPage()">Вернуться к списку задач</div>
    </div>

    <div class="aui-button">
        <div id="downloadPdf" onclick="downloadPDF()">Download diagram</div>
    </div>

    <button class="aui-button aui-dropdown2-trigger" aria-controls="sortBy">
        Sort by
    </button>
    <aui-dropdown-menu id="sortBy">
        <aui-section label="Сортировать">
            <aui-item-radio onclick="reverse()" interactive checked>По возрастанию id</aui-item-radio>
            <aui-item-radio onclick="sort()" interactive>По убыванию id</aui-item-radio>
        </aui-section>
    </aui-dropdown-menu>

##    <button class="aui-button aui-dropdown2-trigger" aria-controls="groupBy">
##        Group by
##    </button>
##    <aui-dropdown-menu id="groupBy">
##        <aui-section label="Группировать">
##            <aui-item-radio onclick="byAuthor()" interactive>По создателю</aui-item-radio>
##        </aui-section>
##    </aui-dropdown-menu>

##    <div class="aui-button">
##        <div id="addTask" onclick="addTask()">Add task</div>
##    </div>

    <div id="gantt"></div>

    <div id="ganttToPDF"></div>
</div>
</body>
</html>

<script>
    var section = document.querySelector('aui-section#сортировать');
    section.addEventListener('change', function (e) {
        var tagName = e.target.tagName.toLowerCase();
        if (tagName === 'aui-item-radio') {
            if (e.target.hasAttribute('checked')) {
                console.log(e.target.textContent, 'was selected.');
            } else {
                console.log(e.target.textContent, 'was deselected.');
            }
        }
    });
</script>

##<script>
##    var section = document.querySelector('aui-section#группировать');
##    section.addEventListener('change', function (e) {
##        var tagName = e.target.tagName.toLowerCase();
##        if (tagName === 'aui-item-radio') {
##            if (e.target.hasAttribute('checked')) {
##                console.log(e.target.textContent, 'was selected.');
##            } else {
##                console.log(e.target.textContent, 'was deselected.');
##            }
##        }
##    });
##</script>

#else
<p>Авторизуйтесь, чтобы получить доступ к плагину</p>
#end
